<!--
*** AUTO-GENERATED FILE ***
This file is auto-generated by BambdaChecker.
Please do not manually edit this file, or include any changes to this file in pull requests.
-->
## [RedirectCSPReportsToCollaborator.bambda](https://github.com/PortSwigger/bambdas/blob/main/MatchAndReplace/Response/RedirectCSPReportsToCollaborator.bambda)
### Modifies the CSP response header to redirect CSP reports to the Collaborator server.
#### Author: PortSwigger
```java
var resp = requestResponse.response();
var csp = "Content-Security-Policy";
var collaborator = "https://" + api().collaborator().defaultPayloadGenerator().generatePayload();

if(!resp.hasHeader(csp)) {
	return resp;
}

var cspValue = resp
    .headerValue(csp)
    .replaceAll("(report-uri|report-to)\\s+[^;]+", "report-to csp-reports");

return resp
    .withUpdatedHeader(csp, cspValue)
    .withRemovedHeader("Reporting-Endpoints")
    .withAddedHeader("Reporting-Endpoints", "csp-reports=\""+collaborator+"\"");

```
